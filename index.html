<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title> \\ å‹•ç‰©æ£®å‹ã®å¤©æ°£é å ± //</title>
  <link rel="icon" type="image/png" href="./icon-v2.png">
  <link rel="apple-touch-icon" href="./icon-v2.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./icon-v2.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap"
        rel="stylesheet">

  <style>
    :root {
      /* å‹•æ£®é¢¨æŸ”å’Œé…è‰²ï¼ˆå¡ç‰‡ç”¨ï¼‰ */
      --ac-sky-top: #bde6ff;
      --ac-sky-mid: #dff5ff;
      --ac-grass: #8fd88a;
      --ac-grass-deep: #5fac66;
      --ac-panel: #fff5dd;
      --ac-panel-deep: #f5e0b7;
      --ac-wood-border: #c89a5b;
      --ac-wood-shadow: rgba(143, 104, 52, 0.35);
      --ac-accent-yellow: #f7e28b;
      --ac-accent-blue: #9fd5ff;
      --ac-text-main: #5a4330;
      --ac-text-soft: #847567;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    /* ===== æ•´é èƒŒæ™¯ï¼šå‹•æ£®å ´æ™¯ background.png ===== */
    body {
      font-family: 'Zen Maru Gothic', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #5a4330;
      min-height: 100vh;
      overflow-x: hidden;
      padding-bottom: 20px;

      background-image: url('./background.png');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      background-attachment: fixed;
    }

    /* é ‚éƒ¨ç‹€æ…‹åˆ—ï¼šåƒå‹•æ£®ç³»çµ±åˆ—çš„å°æœ¨ç‰Œè† å›Š */
    .status-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 9px 16px;
      margin: 10px 12px;
      border-radius: 18px;
      background: rgba(255, 245, 221, 0.92);
      border: 2px solid rgba(255, 255, 255, 0.9);
      box-shadow:
        0 3px 0 rgba(198, 154, 91, 0.75),
        0 0 0 2px rgba(198, 154, 91, 0.6);
      position: sticky;
      top: 8px;
      z-index: 100;
    }

    .location-pill {
      background: var(--ac-accent-yellow);
      color: var(--ac-text-main);
      padding: 5px 14px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.98rem;
      border: 2px solid #ffffff;
      box-shadow: 0 2px 0 rgba(190, 145, 74, 0.4);
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .update-pill {
      font-size: 0.78rem;
      color: var(--ac-text-soft);
      background: rgba(159, 213, 255, 0.9);
      padding: 3px 10px;
      border-radius: 999px;
      border: 2px solid #ffffff;
      font-weight: 700;
      white-space: nowrap;
    }

    .container {
      padding: 16px 18px 18px;
      max-width: 640px;
      margin: 0 auto;
    }

    /* ========== é ‚éƒ¨æ¨™é¡Œ + å‹•æ£® Hero åœ– ========== */

    .ac-header {
      margin-top: 2px;
      margin-bottom: 16px;
    }

    .ac-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 999px;
      background: var(--ac-panel);
      border: 2px solid #ffffff;
      box-shadow:
        0 3px 0 var(--ac-wood-shadow),
        0 0 0 2px var(--ac-wood-border);
      margin-bottom: 10px;
    }

    .ac-title-main {
      font-size: 1.12rem;
      font-weight: 900;
      letter-spacing: 0.08em;
    }

    .ac-title-sub {
      font-size: 0.82rem;
      color: var(--ac-text-soft);
    }

    /*
      Hero åœ–å»ºè­°å°ºå¯¸ï¼š
      - è¨­è¨ˆç¨¿ï¼š640 x 300 px
      - åŒ¯å‡ºï¼š1280 x 600 px (2x)
    */
    /* å¤–æ¡†å¡ç‰‡ */
    .ac-hero-slot {
      width: 100%;
      aspect-ratio: 16 / 7.5;

      background: var(--ac-panel);
      border-radius: 26px;
      border: 3px solid #d5c9b5;
      box-shadow:
        0 4px 0 rgba(200, 154, 91, 0.75),
        0 0 0 2px rgba(200, 154, 91, 0.7);

      padding: 10px;       /* è®“åœ–ç‰‡å…§ç¸®ä¸€åœˆ */
      overflow: hidden;
      position: relative;
    }

    /* å…§éƒ¨ hero åœ–ç‰‡ */
    .ac-hero-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      border-radius: 18px; /* æ¯”å¤–æ¡†å°ä¸€é»çš„åœ“è§’ */
    }

    /* ========== ä»Šæ—¥ç„¦é»å¡ç‰‡ï¼šå‹•æ£®å°è©±æ¡†é¢¨æ ¼ ========== */

    .hero-card {
      background: var(--ac-panel);
      border-radius: 24px;
      padding: 22px 20px 20px;
      text-align: center;
      border: 2px solid #ffffff;
      box-shadow:
        0 4px 0 var(--ac-wood-shadow),
        0 0 0 2px var(--ac-wood-border);
      margin-top: 18px;
      margin-bottom: 20px;
      position: relative;
      overflow: visible;
    }

    /* å°è©±æ¡†å°å°¾å·´ */
    .hero-card::after {
      content: "";
      position: absolute;
      left: 24px;
      bottom: -12px;
      width: 26px;
      height: 18px;
      background: var(--ac-panel);
      border-left: 2px solid #ffffff;
      border-bottom: 2px solid #ffffff;
      box-shadow:
        2px 3px 0 var(--ac-wood-shadow),
        0 0 0 2px var(--ac-wood-border);
      transform: skewX(-20deg);
      border-bottom-left-radius: 12px;
    }

    .hero-card::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background-image:
        radial-gradient(circle at 15% 0%, rgba(255, 255, 255, 0.85) 0, transparent 55%),
        radial-gradient(circle at 85% 100%, rgba(255, 255, 255, 0.55) 0, transparent 60%);
      opacity: 0.7;
      pointer-events: none;
    }

    .hero-period {
      position: absolute;
      top: -14px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--ac-accent-blue);
      color: var(--ac-text-main);
      padding: 4px 22px;
      border-radius: 999px;
      font-weight: 900;
      border: 2px solid #ffffff;
      box-shadow: 0 3px 0 rgba(143, 104, 52, 0.5);
      letter-spacing: 0.08em;
      white-space: nowrap;
      font-size: 0.9rem;
    }

    .hero-temp-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 18px 0 6px;
      position: relative;
      z-index: 1;
    }

    .hero-icon {
      font-size: 3.6rem;
      filter: drop-shadow(0 3px 0 rgba(143, 104, 52, 0.3));
      animation: bob 2.4s infinite ease-in-out;
    }

    @keyframes bob {
      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-5px);
      }
    }

    .hero-temp {
      font-size: 3.9rem;
      font-weight: 900;
      color: var(--ac-text-main);
      line-height: 1;
      text-shadow: 0 2px 0 rgba(255, 255, 255, 0.9);
    }

    .hero-desc {
      font-size: 1.15rem;
      color: var(--ac-text-main);
      margin-bottom: 12px;
      font-weight: 900;
      position: relative;
      z-index: 1;
    }

    .advice-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
      padding-top: 12px;
      border-top: 1px dashed #ddc79e;
      position: relative;
      z-index: 1;
    }

    .advice-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #fffaf0;
      padding: 8px 8px 9px;
      border-radius: 16px;
      border: 1px solid #f0ddbc;
      box-shadow: 0 2px 0 rgba(143, 104, 52, 0.25);
    }

    .advice-icon {
      font-size: 1.5rem;
      margin-bottom: 3px;
    }

    .advice-text {
      font-size: 1.02rem;
      font-weight: 900;
      color: var(--ac-text-main);
      margin: 1px 0 3px;
      line-height: 1.2;
    }

    .advice-item small {
      font-size: 0.72rem;
      color: var(--ac-text-soft);
    }

    /* ========== ç¨å¾Œé å ± ========== */

    .section-title {
      font-size: 0.98rem;
      color: #fffdf6;
      margin-bottom: 8px;
      margin-left: 4px;
      font-weight: 900;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      display: inline-block;
      padding: 5px 12px;
      background: rgba(91, 79, 63, 0.9);
      border-radius: 999px;
      border: 2px solid rgba(255, 255, 255, 0.85);
      box-shadow: 0 3px 0 rgba(64, 53, 43, 0.5);
    }

    .scroll-container {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 3px 0 8px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .scroll-container::-webkit-scrollbar {
      display: none;
    }

    .mini-card {
      min-width: 124px;
      background: var(--ac-panel);
      border-radius: 18px;
      padding: 10px 8px;
      text-align: center;
      border: 1px solid #f0ddbc;
      flex-shrink: 0;
      box-shadow: 0 3px 0 rgba(143, 104, 52, 0.3);
    }

    .mini-time {
      background: var(--ac-grass-deep);
      color: #fffdf4;
      padding: 2px 10px;
      border-radius: 999px;
      font-size: 0.76rem;
      display: inline-block;
      margin-bottom: 5px;
      font-weight: 800;
      white-space: nowrap;
    }

    .mini-icon {
      font-size: 1.8rem;
      margin: 3px 0;
      text-shadow: 0 2px 0 rgba(143, 104, 52, 0.25);
    }

    .mini-temp {
      font-size: 0.98rem;
      font-weight: 800;
      color: var(--ac-text-main);
    }

    .mini-card small {
      font-size: 0.7rem;
      color: var(--ac-text-soft);
    }

    /* Loading ç•«é¢ï¼šä»»å¤©å ‚æ„Ÿç°¡æ½” */

    .loading-screen {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 20% 0%, #ffffff 0, #e7f7ff 45%, transparent 70%),
        linear-gradient(to bottom, #bde6ff 0%, #dff5ff 50%, #8fd88a 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 999;
    }

    .loading-icon {
      font-size: 3.4rem;
      animation: bob 2.2s infinite ease-in-out;
    }

    .loading-badge {
      margin-top: 12px;
      background: var(--ac-panel);
      border-radius: 999px;
      border: 2px solid #ffffff;
      padding: 6px 18px;
      box-shadow:
        0 3px 0 var(--ac-wood-shadow),
        0 0 0 2px var(--ac-wood-border);
      font-weight: 900;
      letter-spacing: 0.08em;
      font-size: 0.86rem;
    }

    .loading-text {
      color: var(--ac-text-main);
      font-weight: 700;
      margin-top: 10px;
      font-size: 0.84rem;
      padding: 5px 14px;
      background: rgba(255, 245, 221, 0.96);
      border-radius: 999px;
      border: 2px solid #f0ddbc;
    }

    @media (max-width: 360px) {
      .hero-temp {
        font-size: 3.4rem;
      }

      .hero-icon {
        font-size: 3.1rem;
      }

      .advice-text {
        font-size: 0.96rem;
      }

      .mini-card {
        min-width: 116px;
      }
    }
  </style>
</head>

<body>
  <div id="loading" class="loading-screen">
    <div class="loading-icon">â›…</div>
    <div class="loading-badge">å°é®æ°£è±¡çœ‹æ¿</div>
    <p class="loading-text">è±†ç‹¸æ­£åœ¨ç¿»å‡ºä»Šå¤©çš„é å ±â€¦</p>
  </div>

  <div class="status-bar">
    <div class="location-pill">å‹•æ£®å°é®çš„è¥¿æ–½æƒ æ­£åœ¨æ’­å ±ä¸­å–”...</div>
    <div id="updateTime" class="update-pill">æ›´æ–°ä¸­...</div>
  </div>

  <div class="container" id="mainContent" style="display: none;">

    <!-- é ‚éƒ¨æ¨™é¡Œï¼‹å‹•æ£®é¢¨ Hero åœ– -->
    <header class="ac-header">
      <div class="ac-title">
        <span class="ac-title-main">æ£®å‹å€‘é›†åˆå•¦ï¼</span>
        <span class="ac-title-sub">ä»Šå¤©çš„å¤©æ°£é©åˆåšä»€éº¼å‘¢...</span>
      </div>

      <div class="ac-hero-slot">
        <img src="./hero.png" alt="å‹•ç‰©æ£®å‹ã®å¤©æ°£é å ± Hero" class="ac-hero-img">
      </div>
    </header>

    <div id="heroCard"></div>

    <h3 class="section-title">ç¨å¾Œé å ±</h3>
    <div class="scroll-container" id="futureForecasts"></div>

  </div>

  <script>
    const API_URL = "https://weather-mk.zeabur.app/api/weather/kaohsiung";

    function getWeatherIcon(weather) {
      if (!weather) return "ğŸŒ¤ï¸";
      if (weather.includes("æ™´")) return "â˜€ï¸";
      if (weather.includes("å¤šé›²")) return "â›…";
      if (weather.includes("é™°")) return "â˜ï¸";
      if (weather.includes("é›¨")) return "ğŸŒ§ï¸";
      if (weather.includes("é›·")) return "â›ˆï¸";
      return "ğŸŒ¤ï¸";
    }

    function getAdvice(rainProb, maxTemp) {
      let rainIcon = "ğŸŒ‚";
      let rainText = "ä¸ç”¨å¸¶å‚˜";
      if (parseInt(rainProb) > 30) {
        rainIcon = "â˜‚ï¸";
        rainText = "è¨˜å¾—å¸¶å‚˜ï¼";
      }

      let clothIcon = "ğŸ‘•";
      let clothText = "èˆ’é©ç©¿æ­";
      if (parseInt(maxTemp) >= 28) {
        clothIcon = "ğŸ½";
        clothText = "çŸ­è¢–å‡ºç™¼";
      } else if (parseInt(maxTemp) <= 20) {
        clothIcon = "ğŸ§¥";
        clothText = "åŠ ä»¶å¤–å¥—";
      }

      return { rainIcon, rainText, clothIcon, clothText };
    }

    function getTimePeriod(startTime) {
      const hour = new Date(startTime).getHours();
      if (hour >= 5 && hour < 11) return "æ—©æ™¨";
      if (hour >= 11 && hour < 14) return "ä¸­åˆ";
      if (hour >= 14 && hour < 18) return "ä¸‹åˆ";
      if (hour >= 18 && hour < 23) return "æ™šä¸Š";
      return "æ·±å¤œ";
    }

    function renderWeather(data) {
      const forecasts = data.forecasts;
      const current = forecasts[0];
      const others = forecasts.slice(1);

      const advice = getAdvice(current.rain, current.maxTemp);
      const period = getTimePeriod(current.startTime);
      const avgTemp = Math.round((parseInt(current.maxTemp) + parseInt(current.minTemp)) / 2);

      document.getElementById('heroCard').innerHTML = `
        <div class="hero-card">
          <div class="hero-period">${period}</div>
          <div class="hero-temp-container">
            <div class="hero-icon">${getWeatherIcon(current.weather)}</div>
            <div class="hero-temp">${avgTemp}Â°</div>
          </div>
          <div class="hero-desc">${current.weather}</div>
          <div class="advice-grid">
            <div class="advice-item">
              <div class="advice-icon">${advice.rainIcon}</div>
              <div class="advice-text">${advice.rainText}</div>
              <small>é™é›¨ç‡ ${current.rain}</small>
            </div>
            <div class="advice-item">
              <div class="advice-icon">${advice.clothIcon}</div>
              <div class="advice-text">${advice.clothText}</div>
              <small>æœ€é«˜æº« ${current.maxTemp}Â°</small>
            </div>
          </div>
        </div>
      `;

      const scrollContainer = document.getElementById('futureForecasts');
      scrollContainer.innerHTML = '';

      const todayDate = new Date().getDate();

      others.forEach(f => {
        let p = getTimePeriod(f.startTime);
        const fDate = new Date(f.startTime);
        if (fDate.getDate() !== todayDate) {
          p = "æ˜å¤©" + p;
        }

        scrollContainer.innerHTML += `
          <div class="mini-card">
            <div class="mini-time">${p}</div>
            <div class="mini-icon">${getWeatherIcon(f.weather)}</div>
            <div class="mini-temp">${f.minTemp}Â° - ${f.maxTemp}Â°</div>
            <small>ğŸ’§${f.rain}</small>
          </div>
        `;
      });

      const now = new Date();
      const month = now.getMonth() + 1;
      const date = now.getDate();
      const dayIndex = now.getDay();
      const days = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];

      document.getElementById('updateTime').textContent =
        `${month}æœˆ${date}æ—¥ ${days[dayIndex]}`;
    }

    async function fetchWeather() {
      try {
        const delayPromise = new Promise(resolve => setTimeout(resolve, 1500));
        const fetchPromise = fetch(API_URL).then(res => res.json());
        const [_, json] = await Promise.all([delayPromise, fetchPromise]);

        if (json.success) {
          renderWeather(json.data);
          document.getElementById('loading').style.display = 'none';
          document.getElementById('mainContent').style.display = 'block';
        } else {
          throw new Error("API Error");
        }
      } catch (e) {
        console.error(e);
        alert("å¤©æ°£è³‡æ–™è®€å–å¤±æ•—ï¼Œå¯èƒ½è¢«æµ·é·—å¼èµ°äº†ï¼Œå†è©¦ä¸€æ¬¡çœ‹çœ‹ï¼");
      }
    }

    document.addEventListener("DOMContentLoaded", fetchWeather);
  </script>
</body>

</html>
